{"version":3,"sources":["components/input-block/inputBlock.js","components/item-add-form/item-add-form.js","components/item-add-form/index.js","components/spinner/index.js","components/spinner/spinner.js","components/item-list/index.js","components/item-list/item-list.js","components/message/index.js","components/message/message.js","components/sign-in/index.js","components/sign-in/sign-in.js","firebase.js","components/app/index.js","components/app/app.js","index.js"],"names":["InputBlock","onHandleChange","data","prevValue","title","type","name","currentMonth","value","className","disabled","onChange","e","target","defaultProps","ItemAddForm","state","iceWater","hotWaterBack","hotWater","gas","light","onSubmit","preventDefault","cb","props","onItemAdded","form","Number","month","Date","reset","handleChange","val","setState","oldItem","getTwoDigitDateFormat","monthOrDate","this","lastCounters","currentDate","renderDate","getFullYear","getMonth","required","defaultValue","Component","Spinner","role","ItemList","items","onItemDelete","Object","keys","length","sort","a","b","seconds","elements","values","map","item","id","renderTime","toDate","toLocaleDateString","year","key","onClick","message","text","SignIn","onSignIn","password","placeholder","firebase","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","firestore","fireauth","auth","App","maxId","dataRef","collection","msgType","months","userAuth","componentDidMount","async","get","snapshop","docs","collectIdsAndDocs","slice","pop","onAuthStateChanged","user","uid","showMsg","msgText","msgTimeout","setTimeout","ItemAdd","add","docRef","doc","newPost","ItemDelete","window","confirm","console","log","delete","allMonths","filter","pass","signInWithEmailAndPassword","then","res","catch","error","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.18aee080.chunk.js","sourcesContent":["import React from \"react\";\nimport PropTypes from 'prop-types';\n\nconst InputBlock = ({onHandleChange, data, prevValue}) => {\n  const {title, type, name, value} = data;\n  \n  const currentMonth = value - prevValue;\n  return (\n    \n    <div className=\"col-6\">\n        <div className=\"form-row\">\n          <div className=\"col\">\n            <div className=\"mb-2\">{title}</div>\n            <div className=\"form-group\">\n              <input className=\"form-control\" value={prevValue} disabled />\n              <small className=\"form-text text-muted\">прошлый месяц</small>\n            </div>\n          </div>\n          <div className=\"col\">\n            <div className=\"mb-2 text-secondary\">{currentMonth > 0 ? currentMonth : '...'}</div>\n            <div className=\"form-group\">\n              <input\n                type={type}\n                name={name}\n                onChange={(e)=> onHandleChange(name, e.target.value)}\n                className=\"form-control\" />\n              <small className=\"form-text text-muted\">текущий месяц</small>\n            </div>\n          </div>\n        </div>\n      </div>\n  )\n}\nInputBlock.defaultProps = {\n  prevValue: 0\n}\nInputBlock.propTypes = {\n  data: PropTypes.shape({\n    title: PropTypes.node,\n    type: PropTypes.string,\n    name: PropTypes.string,\n    value: PropTypes.oneOfType([ PropTypes.string, PropTypes.number ])\n  })\n}\n\nexport default InputBlock;","import React, { Component } from \"react\";\nimport InputBlock from '../input-block/inputBlock'\n\nexport default class ItemAddForm extends Component {\n  static defaultProps = {\n    lastCounters: {}\n  }\n  state = {\n    iceWater: { title: \"Холодна вода\", name: \"iceWater\", value: \"\" },\n    hotWaterBack: { title: \"Г.В.В\", name: \"hotWaterBack\", value: \"\" },\n    hotWater: { title: \"Горячая вода\", name: \"hotWater\", value: \"\" },\n    gas: { title: \"Газ\", name: \"gas\", value: \"\" },\n    light: { title: \"Свет\", name: \"light\", value: \"\" },\n  }\n\n\n  onSubmit = e => {\n    e.preventDefault();\n\n    const cb = this.props.onItemAdded;\n    const form = e.target;\n\n    const item = {\n      iceWater: Number(form.iceWater.value),\n      hotWater: Number(form.hotWater.value),\n      hotWaterBack: Number(form.hotWaterBack.value),\n      light: Number(form.light.value),\n      gas: Number(form.gas.value),\n      month: new Date(form.month.value)\n    };    \n    \n    cb(item);\n    form.reset();\n  };\n  handleChange = (name, val) => {\n    this.setState((state)=>{\n      const oldItem = state[name];\n      return {\n        [name]: {...oldItem, value: val}\n      }\n    });\n  }\n  getTwoDigitDateFormat = (monthOrDate) => (monthOrDate < 10) ? '0' + monthOrDate : monthOrDate;\n\n  render() {\n    const { onSubmit, handleChange, getTwoDigitDateFormat } = this;\n    const { lastCounters } = this.props;\n    const { iceWater, hotWaterBack, hotWater, gas, light } = this.state;\n\n    const currentDate = new Date();\n    const renderDate = `${currentDate.getFullYear()}-${getTwoDigitDateFormat(currentDate.getMonth() + 1)}`;\n\n    \n    \n    return (\n      <div className=\"col-md-8 mx-auto\">\n        <div className=\"d-flex justify-content-center\">\n          <form onSubmit={onSubmit}>\n            <div className=\"form-row\">\n              <InputBlock\n                onHandleChange={handleChange}\n                data={iceWater}\n                prevValue={lastCounters.iceWater} />\n\n              <InputBlock \n                onHandleChange={handleChange} \n                data={hotWaterBack} \n                prevValue={lastCounters.hotWaterBack} />\n\n              <InputBlock \n                onHandleChange={handleChange} \n                data={hotWater} \n                prevValue={lastCounters.hotWater} />\n\n              <InputBlock \n                onHandleChange={handleChange} \n                data={gas} \n                prevValue={lastCounters.gas} />\n\n              <InputBlock \n                onHandleChange={handleChange} \n                data={light} \n                prevValue={lastCounters.light} />\n\n              <div className=\"col\">\n                <div className=\"form-row\">\n                  <div className=\"col-12 mb-2\">\n                    <span className=\"text-success\">Месяц</span>\n                  </div>\n                  <div className=\"col\">\n                    <div className=\"form-group\">\n                      <input\n                        required\n                        type=\"month\"\n                        name=\"month\"\n                        defaultValue={renderDate}\n                        className=\"form-control\"\n                      />\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <button type=\"submit\" className=\"btn btn-success\">\n              Добавить\n            </button>\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n","import ItemAddForm from \"./item-add-form\";\n\nexport default ItemAddForm;\n","import Spinner from './spinner';\n\nexport default Spinner;","import React from 'react';\nconst spinner = () => {\n  return (\n    <div className=\"d-flex justify-content-center mt-5\">\n      <div className=\"spinner-border text-secondary\" role=\"status\">\n        <span className=\"sr-only\">Загрузка...</span>\n      </div>\n    </div>\n  );\n}\nexport default spinner;","import ItemList from \"./item-list\";\n\nexport default ItemList;\n","import React from \"react\";\nimport Spinner from \"../spinner\";\n\nconst ItemList = ({ items, onItemDelete }) => {\n  \n  if(items === null) {\n    return (\n      <div className=\"col-md-8 mx-auto mt-4\">\n        <Spinner />\n      </div>\n    );\n  }\n\n  if (!Object.keys(items).length) {\n    return (\n      <div className=\"col-md-8 mx-auto mt-4\">\n        <p>Внесите первые данные.</p>\n      </div>\n    );\n  }\n\n  items.sort((a,b) => b.month.seconds - a.month.seconds);\n\n  const listItems = Object.values(items);\n  const elements = listItems.map(item => {\n    const { id, iceWater, hotWater, hotWaterBack, light, gas, month } = item;\n    const renderTime = month.toDate().toLocaleDateString('ua-UA', {month: 'numeric', year: 'numeric'});\n    \n    return (\n      <tr key={id}>\n        <td>{renderTime}</td>\n        <td>{iceWater}</td>\n        <td>{hotWater}</td>\n        <td>{hotWaterBack}</td>\n        <td>{light}</td>\n        <td>{gas}</td>\n        <td>\n          <button\n            onClick={() => onItemDelete(id)}\n            className=\"btn btn-danger btn-sm\"\n          >\n            <i className=\"far fa-trash-alt\"></i>\n          </button>\n        </td>\n      </tr>\n    );\n  });\n\n  return (\n    <div className=\"col-md-8 mx-auto mt-4\">\n      <h2 className=\"text-center\">История</h2>\n      <div className=\"table-responsive-xl\">\n        <table className=\"table\">\n          <thead>\n            <tr>\n              <th>#</th>\n              <th>Холодная вода</th>\n              <th>Горячая вода</th>\n              <th>Г.В.В</th>\n              <th>Свет</th>\n              <th>Газ</th>\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>{elements}</tbody>\n        </table>\n      </div>\n    </div>\n  );\n};\n\nexport default ItemList;\n","import message from \"./message\";\n\nexport default message;\n","import React from \"react\";\nimport \"./message.css\";\nconst message = ({ type, text }) => {\n  if (!text) {\n    return null;\n  }\n  const wordType = [\"danger\", \"success\", \"warning\"];\n  return (\n    <div className=\"bMessage\">\n      <div className={`alert alert-${wordType[type]}`} role=\"alert\">\n        {text}\n      </div>\n    </div>\n  );\n};\n\nexport default message;\n","import SignIn from \"./sign-in\";\n\nexport default SignIn;\n","import React from 'react';\n\nconst SignIn = ({onSignIn}) => {\n\n  const onSubmit = (e) => {\n    e.preventDefault();\n\n    const form = e.target;\n    onSignIn(form.password.value);\n    form.reset();\n  }\n  return (\n    <div className=\"col-md-8 mx-auto\">\n        <div className=\"d-flex justify-content-center\">\n          <form onSubmit={onSubmit}>\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <input className=\"form-control\" type=\"password\" name=\"password\" placeholder=\"Пароль\" />\n              </div>\n            </div>\n            <div className=\"text-center\">\n              <button type=\"submit\" className=\"btn btn-success\">\n                Войти\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n  )\n}\n\nexport default SignIn;","import firebase from \"firebase/app\";\nimport \"firebase/firestore\";\nimport \"firebase/firebase-auth\";\n\n// Your web app's Firebase configuration\nconst firebaseConfig = {\n  apiKey: \"AIzaSyCfM0byadtN0hT5NHZic-iIXuNByceebBM\",\n  authDomain: \"housing-meter.firebaseapp.com\",\n  databaseURL: \"https://housing-meter.firebaseio.com\",\n  projectId: \"housing-meter\",\n  storageBucket: \"housing-meter.appspot.com\",\n  messagingSenderId: \"1004021485217\",\n  appId: \"1:1004021485217:web:d6d4d3057749769353eae0\"\n};\n// Initialize Firebase\nfirebase.initializeApp(firebaseConfig);\n\nexport default firebase;\n\nexport const firestore = firebase.firestore();\nexport const fireauth= firebase.auth();\n","import App from \"./app\";\n\nexport default App;\n","import React, { Component } from \"react\";\nimport ItemAddForm from \"../item-add-form\";\nimport ItemList from \"../item-list\";\nimport Message from \"../message\";\nimport SignIn from \"../sign-in\";\nimport { firestore, fireauth } from \"../../firebase\";\n\nexport default class App extends Component {\n  maxId = 100;\n  dataRef = firestore.collection('apartment/ODbPGN3kqlmPiQUhjc9Z/months/');\n  state = {\n    lastCounters: {},\n    msgType: 0, // 0: danger | 1: success | 2: warning\n    months: null,\n    userAuth: null\n  };\n  componentDidMount = async () => {\n    \n    const snapshop = await this.dataRef.get();\n    const months = snapshop.docs.map(this.collectIdsAndDocs);\n    const lastCounters = months.slice().pop();\n\n    await fireauth.onAuthStateChanged((user) => {\n      const userAuth = user ? user.uid : null;\n      this.setState({\n        userAuth\n      });\n    });\n    \n    this.setState({\n      months,\n      lastCounters\n    });\n    \n  }\n  collectIdsAndDocs(doc) {\n    return {id: doc.id, ...doc.data()};\n  }\n  showMsg = (msgText, msgType = 1, msgTimeout = 5000) => {\n    this.setState({\n      msgType,\n      msgText\n    });\n\n    setTimeout(() => {\n      this.setState({\n        msgText: \"\"\n      });\n    }, msgTimeout);\n  };\n\n  ItemAdd = async item => {\n    const { dataRef, showMsg } = this;\n\n    const docRef = await dataRef.add(item);\n    const doc = await docRef.get();\n    const newPost = this.collectIdsAndDocs(doc);\n\n    this.setState(({months}) => ({months: [newPost, ...months]}));\n\n    showMsg(\"Показатели счетчиков успешно добавлены!\");\n  };\n\n  ItemDelete = async id => {\n    let confirmAc = window.confirm(\"Вы действительно хотите удалить запись?\");\n    if (!confirmAc) return;\n    console.log(id);\n    \n    await this.dataRef.doc(id).delete();\n    \n    const allMonths = this.state.months;\n    const months = allMonths.filter(month => month.id !== id);\n    this.setState({ months });\n\n    this.showMsg(\"Показатели счетчиков успешно удалены!\");\n  };\n\n  onSignIn = async pass => {\n\n    await fireauth.signInWithEmailAndPassword('prainua@gmail.com', pass).then((res) => {\n      \n      const userAuth = res.user.uid;\n      this.setState({ userAuth });  \n      this.showMsg('Вы успешно вошли!');\n\n    }).catch(function(error) {\n      this.showMsg(error.message, 0);\n    });\n  }\n\n  render() {\n    const { months, msgType, msgText, lastCounters, userAuth } = this.state;\n    if(userAuth) {\n      \n      return (\n        <div className=\"container\">\n          <div className=\"row\">\n            <Message type={msgType} text={msgText} />\n            <ItemAddForm onItemAdded={this.ItemAdd} lastCounters={lastCounters} />\n            <ItemList items={months} onItemDelete={this.ItemDelete} />\n          </div>\n        </div>\n      );\n    } else {\n      return (\n        <div className=\"container\">\n          <div className=\"row\">\n            <Message type={msgType} text={msgText} />\n            <SignIn onSignIn={this.onSignIn} />\n          </div>\n        </div>\n      );\n    }\n    \n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./components/app\";\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}